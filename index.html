<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åç³»çµ±</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #e53935, #d32f2f);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .header h1 i {
            font-size: 32px;
        }
        
        .control-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 25px;
            background-color: #f9f9f9;
            border-bottom: 1px solid #eee;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
        }
        
        .control-group label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        select, input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        select:focus, input:focus {
            border-color: #e53935;
            outline: none;
        }
        
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .attendance-table th {
            background-color: #f2f2f2;
            padding: 16px 12px;
            text-align: left;
            font-weight: bold;
            color: #444;
            border-bottom: 2px solid #ddd;
            position: sticky;
            top: 0;
        }
        
        .attendance-table td {
            padding: 14px 12px;
            border-bottom: 1px solid #eee;
        }
        
        .attendance-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .status-select {
            width: 100%;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #ccc;
            font-weight: bold;
        }
        
        .status-yes { color: #2e7d32; }
        .status-abs { color: #ff8f00; }
        .status-o { color: #c62828; }
        .status-l { color: #0277bd; }
        .status-s { color: #6a1b9a; }
        .status-c { color: #283593; }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            padding: 25px;
            justify-content: center;
            border-top: 1px solid #eee;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-primary {
            background-color: #25D366;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1da851;
        }
        
        .btn-secondary {
            background-color: #e53935;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #c62828;
        }
        
        .btn-tertiary {
            background-color: #546e7a;
            color: white;
        }
        
        .btn-tertiary:hover {
            background-color: #455a64;
        }
        
        .output-section {
            padding: 0 25px 25px;
        }
        
        .output-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        textarea {
            width: 100%;
            height: 300px;
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            line-height: 1.6;
            resize: vertical;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            flex: 1;
            min-width: 150px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 5px solid #e53935;
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #e53935;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        .emoji {
            font-size: 18px;
        }
        
        .footer {
            text-align: center;
            padding: 15px;
            color: #777;
            font-size: 14px;
            border-top: 1px solid #eee;
            background-color: #f9f9f9;
        }
        
        @media (max-width: 768px) {
            .control-panel {
                grid-template-columns: 1fr;
            }
            
            .attendance-table {
                display: block;
                overflow-x: auto;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-table-tennis-paddle-ball"></i> ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åç³»çµ±</h1>
        </div>
        
        <div class="control-panel">
            <div class="control-group">
                <label><i class="fas fa-calendar-alt"></i> é¸æ“‡æ—¥æœŸ</label>
                <input type="date" id="datePicker">
            </div>
            
            <div class="control-group">
                <label><i class="fas fa-clock"></i> è¨“ç·´æ™‚é–“</label>
                <select id="timeSlot">
                    <option value="æ˜ŸæœŸå›› (16:00-18:00)">æ˜ŸæœŸå›› (16:00-18:00)</option>
                    <option value="æ˜ŸæœŸå…­ (10:00-13:00)">æ˜ŸæœŸå…­ (10:00-13:00)</option>
                </select>
            </div>
            
            <div class="control-group">
                <label><i class="fas fa-map-marker-alt"></i> è¨“ç·´åœ°é»</label>
                <select id="locationSelect">
                    <option value="åœ“æ´²è§’é«”è‚²é¤¨">åœ“æ´²è§’é«”è‚²é¤¨</option>
                    <option value="ä¿å®‰é“é«”è‚²é¤¨">ä¿å®‰é“é«”è‚²é¤¨</option>
                </select>
            </div>
            
            <div class="control-group">
                <label><i class="fas fa-user-tie"></i> è² è²¬æ•™ç·´</label>
                <input type="text" id="coachInput" value="æ¢é‡‘ç¥ã€å†¼ä½©è“®" readonly>
            </div>
        </div>
        
        <div style="overflow-x: auto; padding: 0 25px;">
            <table class="attendance-table">
                <thead>
                    <tr>
                        <th width="50">ç·¨è™Ÿ</th>
                        <th width="200">æ©Ÿæ§‹åç¨±</th>
                        <th width="150">é‹å‹•å“¡å§“å</th>
                        <th width="80">æ€§åˆ¥</th>
                        <th width="200">å‡ºå¸­ç‹€æ…‹</th>
                    </tr>
                </thead>
                <tbody id="attendanceBody">
                    <!-- é‹å‹•å“¡æ•¸æ“šå°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
        
        <div class="action-buttons">
            <button class="btn btn-primary" id="generateBtn">
                <i class="fab fa-whatsapp"></i> ç”ŸæˆWhatsAppé»åæ–‡æ¡ˆ
            </button>
            <button class="btn btn-secondary" id="resetBtn">
                <i class="fas fa-redo"></i> é‡è¨­æ‰€æœ‰ç‹€æ…‹
            </button>
            <button class="btn btn-tertiary" id="copyBtn">
                <i class="far fa-copy"></i> è¤‡è£½æ–‡æ¡ˆåˆ°å‰ªè²¼ç°¿
            </button>
        </div>
        
        <div class="output-section">
            <div class="output-title">
                <h3><i class="fas fa-file-alt"></i> WhatsAppé»åæ–‡æ¡ˆ</h3>
            </div>
            <textarea id="outputText" readonly placeholder="é»åæ–‡æ¡ˆå°‡åœ¨æ­¤é¡¯ç¤º..."></textarea>
            
            <div class="stats" id="statsContainer">
                <!-- çµ±è¨ˆæ•¸æ“šå°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="footer">
            <p>æ­¤ç³»çµ±å°ˆç‚ºä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åè¨­è¨ˆ &copy; 2023</p>
        </div>
    </div>

    <script>
        // é‹å‹•å“¡æ•¸æ“š
        const athletes = [
            { id: 1, name: "é™³æ³³å²", gender: "F", institution: "æ‰ä¿Š" },
            { id: 2, name: "é™³ç´«æ¼©", gender: "F", institution: "æ‰ä¿Š" },
            { id: 3, name: "ç¾…å˜‰ç†™", gender: "M", institution: "åŸºé †" },
            { id: 4, name: "é»ƒé§¿ğ§™—", gender: "M", institution: "è§€å¡˜å±•äº®" },
            { id: 5, name: "ææ–‡ç", gender: "M", institution: "è§€å¡˜å±•äº®" },
            { id: 6, name: "è¨±éŠ˜è³¢", gender: "M", institution: "ç…å­æœƒæ™¨å´—" },
            { id: 7, name: "è¯æ‚…æ©", gender: "F", institution: "æ¾å¶ºè·è¨“" },
            { id: 8, name: "å¼µæ¢“è³¢", gender: "M", institution: "æ•‘ä¸»" },
            { id: 9, name: "ALESIVAN", gender: "M", institution: "æ•‘ä¸»" },
            { id: 10, name: "é™³æ°¸æ‚…", gender: "F", institution: "æ²™ç”°å…¬ç«‹" },
            { id: 11, name: "å³å®¶ä¿Š", gender: "M", institution: "æ²™ç”°å…¬ç«‹" },
            { id: 12, name: "é™³æ¾¤è³¢", gender: "M", institution: "æ²™ç”°å…¬ç«‹" },
            { id: 13, name: "çŸ³æŒ¯æ˜Ÿ", gender: "M", institution: "è¥¿å€æ™¨è¼" },
            { id: 14, name: "å¼µæ€æ¾ˆ", gender: "M", institution: "å¾ªé“è¡›ç†" }
        ];
        
        // å‡ºå¸­ç‹€æ…‹é¸é …
        const statusOptions = [
            { value: "Yes", text: "âœ… å‡ºå¸­", emoji: "âœ…", class: "status-yes" },
            { value: "Abs", text: "ğŸ“ è«‹å‡", emoji: "ğŸ“", class: "status-abs" },
            { value: "O", text: "âŒ ç„¡æ•…ç¼ºå¸­", emoji: "âŒ", class: "status-o" },
            { value: "L", text: "â° é²åˆ°", emoji: "â°", class: "status-l" },
            { value: "S", text: "ğŸ¤’ ç—…å‡", emoji: "ğŸ¤’", class: "status-s" },
            { value: "C", text: "ğŸ† å‡ºå¤–æ¯”è³½", emoji: "ğŸ†", class: "status-c" }
        ];
        
        // åˆå§‹åŒ–é é¢
        document.addEventListener('DOMContentLoaded', function() {
            // è¨­ç½®é»˜èªæ—¥æœŸç‚ºä»Šå¤©
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById('datePicker').value = formattedDate;
            
            // ç”Ÿæˆé‹å‹•å“¡è¡¨æ ¼
            generateAthleteTable();
            
            // ç‚ºæŒ‰éˆ•æ·»åŠ äº‹ä»¶ç›£è½å™¨
            document.getElementById('generateBtn').addEventListener('click', generateWhatsAppMessage);
            document.getElementById('resetBtn').addEventListener('click', resetAllStatus);
            document.getElementById('copyBtn').addEventListener('click', copyToClipboard);
            
            // ç•¶é¸æ“‡æ”¹è®Šæ™‚æ›´æ–°æ–‡æ¡ˆ
            document.getElementById('datePicker').addEventListener('change', generateWhatsAppMessage);
            document.getElementById('timeSlot').addEventListener('change', generateWhatsAppMessage);
            document.getElementById('locationSelect').addEventListener('change', generateWhatsAppMessage);
            
            // åˆå§‹åŒ–ç”Ÿæˆä¸€æ¬¡æ–‡æ¡ˆ
            generateWhatsAppMessage();
        });
        
        // ç”Ÿæˆé‹å‹•å“¡è¡¨æ ¼
        function generateAthleteTable() {
            const tableBody = document.getElementById('attendanceBody');
            tableBody.innerHTML = '';
            
            athletes.forEach(athlete => {
                const row = document.createElement('tr');
                
                // ç·¨è™Ÿ
                const idCell = document.createElement('td');
                idCell.textContent = athlete.id;
                
                // æ©Ÿæ§‹åç¨±
                const institutionCell = document.createElement('td');
                institutionCell.textContent = athlete.institution;
                
                // é‹å‹•å“¡å§“å
                const nameCell = document.createElement('td');
                nameCell.textContent = athlete.name;
                
                // æ€§åˆ¥
                const genderCell = document.createElement('td');
                genderCell.textContent = athlete.gender === 'M' ? 'ç”·' : 'å¥³';
                
                // å‡ºå¸­ç‹€æ…‹ä¸‹æ‹‰é¸å–®
                const statusCell = document.createElement('td');
                const select = document.createElement('select');
                select.className = 'status-select';
                select.dataset.id = athlete.id;
                
                // æ·»åŠ é¸é …
                statusOptions.forEach(option => {
                    const opt = document.createElement('option');
                    opt.value = option.value;
                    opt.textContent = option.text;
                    opt.className = option.class;
                    select.appendChild(opt);
                });
                
                // è¨­ç½®é»˜èªå€¼ç‚º"å‡ºå¸­"
                select.value = "Yes";
                
                // ç•¶ç‹€æ…‹æ”¹è®Šæ™‚æ›´æ–°æ–‡æ¡ˆ
                select.addEventListener('change', generateWhatsAppMessage);
                
                statusCell.appendChild(select);
                
                // å°‡æ‰€æœ‰å–®å…ƒæ ¼æ·»åŠ åˆ°è¡Œä¸­
                row.appendChild(idCell);
                row.appendChild(institutionCell);
                row.appendChild(nameCell);
                row.appendChild(genderCell);
                row.appendChild(statusCell);
                
                tableBody.appendChild(row);
            });
        }
        
        // ç”ŸæˆWhatsAppé»åæ–‡æ¡ˆ
        function generateWhatsAppMessage() {
            const date = document.getElementById('datePicker').value;
            const timeSlot = document.getElementById('timeSlot').value;
            const location = document.getElementById('locationSelect').value;
            const coaches = document.getElementById('coachInput').value;
            
            // æ ¼å¼åŒ–æ—¥æœŸ
            const dateObj = new Date(date);
            const formattedDate = `${dateObj.getFullYear()}å¹´${dateObj.getMonth() + 1}æœˆ${dateObj.getDate()}æ—¥`;
            
            // ç²å–æ˜ŸæœŸå¹¾
            const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            const weekday = weekdays[dateObj.getDay()];
            
            // è¨ˆç®—å‡ºå¸­çµ±è¨ˆ
            let presentCount = 0;
            let absentCount = 0;
            let otherCount = 0;
            
            // ç”Ÿæˆé‹å‹•å“¡ç‹€æ…‹åˆ—è¡¨
            let athleteStatuses = "";
            
            athletes.forEach(athlete => {
                const select = document.querySelector(`select[data-id="${athlete.id}"]`);
                const statusValue = select.value;
                const statusOption = statusOptions.find(opt => opt.value === statusValue);
                
                // æ›´æ–°çµ±è¨ˆ
                if (statusValue === "Yes") {
                    presentCount++;
                } else if (statusValue === "O") {
                    absentCount++;
                } else {
                    otherCount++;
                }
                
                // æ·»åŠ é‹å‹•å“¡ç‹€æ…‹è¡Œ
                const genderText = athlete.gender === 'M' ? 'ç”·' : 'å¥³';
                athleteStatuses += `${athlete.id}. ${athlete.institution} ${athlete.name} (${genderText})ï¼š${statusOption.emoji} ${statusOption.text.replace(/[âœ…ğŸ“âŒâ°ğŸ¤’ğŸ†]/g, '').trim()}\n`;
            });
            
            // è¨ˆç®—å‡ºå¸­ç‡
            const totalAthletes = athletes.length;
            const attendanceRate = ((presentCount / totalAthletes) * 100).toFixed(1);
            
            // ç”Ÿæˆæ™‚é–“æˆ³ï¼ˆ24å°æ™‚åˆ¶ï¼‰
            const now = new Date();
            const timestamp = `${now.getFullYear()}/${(now.getMonth()+1).toString().padStart(2, '0')}/${now.getDate().toString().padStart(2, '0')} ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}`;
            
            // ç”Ÿæˆå®Œæ•´æ–‡æ¡ˆ
            const message = `ğŸ“ ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åè¨˜éŒ„ ğŸ“

ğŸ“… æ—¥æœŸï¼š${formattedDate} (${weekday})
â° æ™‚é–“ï¼š${timeSlot}
ğŸ“ åœ°é»ï¼š${location}
ğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´ï¼š${coaches}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“‹ é‹å‹•å“¡å‡ºå¸­ç‹€æ…‹ï¼š

${athleteStatuses}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š å‡ºå¸­çµ±è¨ˆï¼š
âœ… å‡ºå¸­ï¼š${presentCount}äºº
ğŸ“ è«‹å‡/å…¶ä»–ï¼š${otherCount}äºº
âŒ ç„¡æ•…ç¼ºå¸­ï¼š${absentCount}äºº
ğŸ“ˆ å‡ºå¸­ç‡ï¼š${attendanceRate}%

â±ï¸ è¨˜éŒ„ç”Ÿæˆæ™‚é–“ï¼š${timestamp}
æ­¤è¨˜éŒ„ç”±é»åç³»çµ±è‡ªå‹•ç”Ÿæˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ’¬ å‚³é€è‡³ WhatsAppï¼šhttps://wa.me/?text=${encodeURIComponent(`ğŸ“ ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åè¨˜éŒ„ ğŸ“\n\nğŸ“… æ—¥æœŸï¼š${formattedDate} (${weekday})\nâ° æ™‚é–“ï¼š${timeSlot}\nğŸ“ åœ°é»ï¼š${location}\nğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´ï¼š${coaches}\n\nğŸ“‹ å‡ºå¸­çµ±è¨ˆï¼šâœ… ${presentCount}äºº | ğŸ“ ${otherCount}äºº | âŒ ${absentCount}äºº | ğŸ“ˆ ${attendanceRate}%\n\nâ±ï¸ ${timestamp}`)}`;
            
            // é¡¯ç¤ºåœ¨æ–‡æœ¬å€åŸŸä¸­
            document.getElementById('outputText').value = message;
            
            // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
            updateStats(presentCount, absentCount, otherCount, attendanceRate);
        }
        
        // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
        function updateStats(present, absent, other, rate) {
            const statsContainer = document.getElementById('statsContainer');
            
            statsContainer.innerHTML = `
                <div class="stat-box">
                    <div class="stat-value">${present}</div>
                    <div class="stat-label">âœ… å‡ºå¸­äººæ•¸</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${other}</div>
                    <div class="stat-label">ğŸ“ è«‹å‡/å…¶ä»–</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${absent}</div>
                    <div class="stat-label">âŒ ç„¡æ•…ç¼ºå¸­</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value">${rate}%</div>
                    <div class="stat-label">ğŸ“ˆ æ•´é«”å‡ºå¸­ç‡</div>
                </div>
            `;
        }
        
        // é‡è¨­æ‰€æœ‰ç‹€æ…‹
        function resetAllStatus() {
            if (confirm("ç¢ºå®šè¦é‡è¨­æ‰€æœ‰é‹å‹•å“¡çš„å‡ºå¸­ç‹€æ…‹å—ï¼Ÿ")) {
                const selects = document.querySelectorAll('.status-select');
                selects.forEach(select => {
                    select.value = "Yes";
                });
                generateWhatsAppMessage();
            }
        }
        
        // è¤‡è£½æ–‡æ¡ˆåˆ°å‰ªè²¼ç°¿
        function copyToClipboard() {
            const outputText = document.getElementById('outputText');
            outputText.select();
            outputText.setSelectionRange(0, 99999); // å°æ–¼ç§»å‹•è¨­å‚™
    
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    alert('é»åæ–‡æ¡ˆå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
                } else {
                    throw new Error('è¤‡è£½å¤±æ•—');
                }
            } catch (err) {
                // ä½¿ç”¨æ–°çš„ Clipboard API
                navigator.clipboard.writeText(outputText.value)
                    .then(() => alert('é»åæ–‡æ¡ˆå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼'))
                    .catch(() => alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½æ–‡æ¡ˆã€‚'));
            }
        }
    </script>
</body>
</html>
