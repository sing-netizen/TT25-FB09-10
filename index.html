<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åç³»çµ±</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 25px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e74c3c;
        }
        
        .header h1 {
            color: #e74c3c;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        .header .subtitle {
            color: #666;
            font-size: 16px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-icon {
            font-size: 20px;
            color: #3498db;
        }
        
        .info-text {
            font-weight: 500;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .date-picker, .location-select, .coach-display {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            background-color: white;
        }
        
        .coach-display {
            background-color: #f8f9fa;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            overflow-x: auto;
            display: block;
        }
        
        .attendance-table th {
            background-color: #3498db;
            color: white;
            text-align: left;
            padding: 15px;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        .attendance-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }
        
        .attendance-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .attendance-table tr:hover {
            background-color: #f0f7ff;
        }
        
        .status-select {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            background-color: white;
            cursor: pointer;
        }
        
        .status-yes { background-color: #d4edda; color: #155724; }
        .status-abs { background-color: #fff3cd; color: #856404; }
        .status-o { background-color: #f8d7da; color: #721c24; }
        .status-l { background-color: #d1ecf1; color: #0c5460; }
        .status-s { background-color: #e2e3e5; color: #383d41; }
        .status-c { background-color: #cce5ff; color: #004085; }
        
        .actions {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .btn {
            padding: 14px 25px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
            text-align: center;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-whatsapp {
            background-color: #25D366;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn-whatsapp:hover {
            background-color: #1da851;
        }
        
        .btn-whatsapp:before {
            content: "ğŸ’¬";
        }
        
        .output-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 25px;
            margin-top: 30px;
            border-left: 5px solid #3498db;
        }
        
        .output-container h3 {
            margin-top: 0;
            color: #2c3e50;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .output-text {
            background-color: white;
            padding: 20px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        
        .attendance-stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            min-width: 150px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .actions {
                flex-direction: column;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .attendance-table {
                display: block;
                overflow-x: auto;
            }
            
            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åç³»çµ±</h1>
            <div class="subtitle">ä¾¿æ·ç®¡ç†å­¸å“¡å‡ºå¸­è¨˜éŒ„ï¼Œä¸€éµç”ŸæˆWhatsAppæ¨é€æ–‡æ¡ˆ</div>
        </div>
        
        <div class="info-grid">
            <div class="info-item">
                <span class="info-icon">ğŸ“…</span>
                <div>
                    <div class="info-text">è¨“ç·´æ™‚é–“</div>
                    <div>æ˜ŸæœŸå›› 16:00-18:00 / æ˜ŸæœŸå…­ 10:00-13:00</div>
                </div>
            </div>
            <div class="info-item">
                <span class="info-icon">ğŸ‘¨â€ğŸ«</span>
                <div>
                    <div class="info-text">è² è²¬æ•™ç·´</div>
                    <div>æ¢é‡‘ç¥ã€å†¼ä½©è“®</div>
                </div>
            </div>
            <div class="info-item">
                <span class="info-icon">ğŸ“</span>
                <div>
                    <div class="info-text">è¨“ç·´åœ°é»</div>
                    <div>åœ“æ´²è§’é«”è‚²é¤¨ / ä¿å®‰é“é«”è‚²é¤¨</div>
                </div>
            </div>
            <div class="info-item">
                <span class="info-icon">ğŸ‘¥</span>
                <div>
                    <div class="info-text">å­¸å“¡äººæ•¸</div>
                    <div>14äºº</div>
                </div>
            </div>
        </div>
        
        <div class="input-group">
            <label for="date">ğŸ“… é¸æ“‡è¨“ç·´æ—¥æœŸ</label>
            <input type="date" id="date" class="date-picker">
        </div>
        
        <div class="input-group">
            <label for="location">ğŸ“ é¸æ“‡è¨“ç·´åœ°é»</label>
            <select id="location" class="location-select">
                <option value="åœ“æ´²è§’é«”è‚²é¤¨">åœ“æ´²è§’é«”è‚²é¤¨</option>
                <option value="ä¿å®‰é“é«”è‚²é¤¨">ä¿å®‰é“é«”è‚²é¤¨</option>
            </select>
        </div>
        
        <div class="input-group">
            <label for="coach">ğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´</label>
            <div id="coach" class="coach-display">æ¢é‡‘ç¥ã€å†¼ä½©è“®</div>
        </div>
        
        <h3>å­¸å“¡å‡ºå¸­è¨˜éŒ„è¡¨</h3>
        <table class="attendance-table">
            <thead>
                <tr>
                    <th width="5%">ç·¨è™Ÿ</th>
                    <th width="15%">æ©Ÿæ§‹åç¨±</th>
                    <th width="20%">å­¸å“¡å§“å</th>
                    <th width="10%">æ€§åˆ¥</th>
                    <th width="30%">å‡ºå¸­ç‹€æ…‹</th>
                    <th width="20%">å‚™è¨»</th>
                </tr>
            </thead>
            <tbody id="attendance-body">
                <!-- å­¸å“¡è¨˜éŒ„å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </tbody>
        </table>
        
        <div class="actions">
            <button class="btn btn-primary" id="generate-report">ğŸ“Š ç”Ÿæˆå‡ºå¸­å ±å‘Š</button>
            <button class="btn btn-success" id="reset-all">ğŸ”„ é‡è¨­æ‰€æœ‰ç‹€æ…‹</button>
            <button class="btn btn-whatsapp" id="whatsapp-btn">æ¨é€è‡³WhatsApp</button>
        </div>
        
        <div class="output-container">
            <h3>WhatsAppæ¨é€æ–‡æ¡ˆ <span id="copy-indicator" style="font-size:14px; color:#666; font-weight:normal;"></span></h3>
            <div class="output-text" id="whatsapp-output"></div>
            <div class="attendance-stats" id="attendance-stats">
                <!-- å‡ºå¸­ç‡çµ±è¨ˆå°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // å­¸å“¡æ•¸æ“š
        const students = [
            { id: 1, institution: "æ‰ä¿Š", name: "é™³æ³³å²", gender: "F" },
            { id: 2, institution: "æ‰ä¿Š", name: "é™³ç´«æ¼©", gender: "F" },
            { id: 3, institution: "åŸºé †", name: "ç¾…å˜‰ç†™", gender: "M" },
            { id: 4, institution: "è§€å¡˜å±•äº®", name: "é»ƒé§¿ğ§™—", gender: "M" },
            { id: 5, institution: "è§€å¡˜å±•äº®", name: "ææ–‡ç", gender: "M" },
            { id: 6, institution: "ç…å­æœƒæ™¨å´—", name: "è¨±éŠ˜è³¢", gender: "M" },
            { id: 7, institution: "æ¾å¶ºè·è¨“", name: "è¯æ‚…æ©", gender: "F" },
            { id: 8, institution: "è§€å¡˜å±•äº®", name: "å¼µæ¢“è³¢", gender: "M" },
            { id: 9, institution: "æ•‘ä¸»", name: "ALESIVAN", gender: "M" },
            { id: 10, institution: "æ²™ç”°å…¬ç«‹", name: "é™³æ°¸æ‚…", gender: "F" },
            { id: 11, institution: "æ²™ç”°å…¬ç«‹", name: "å³å®¶ä¿Š", gender: "M" },
            { id: 12, institution: "æ²™ç”°å…¬ç«‹", name: "é™³æ¾¤è³¢", gender: "M" },
            { id: 13, institution: "è¥¿å€æ™¨è¼", name: "çŸ³æŒ¯æ˜Ÿ", gender: "M" },
            { id: 14, institution: "å¾ªé“è¡›ç†", name: "å¼µæ€æ¾ˆ", gender: "M" }
        ];
        
        // ç‹€æ…‹é¸é …
        const statusOptions = [
            { value: "Yes", text: "âœ… å‡ºå¸­", class: "status-yes" },
            { value: "Abs", text: "ğŸ“ è«‹å‡", class: "status-abs" },
            { value: "O", text: "âŒ ç„¡æ•…ç¼ºå¸­", class: "status-o" },
            { value: "L", text: "â° é²åˆ°", class: "status-l" },
            { value: "S", text: "ğŸ¤’ ç—…å‡", class: "status-s" },
            { value: "C", text: "ğŸ† å‡ºå¤–æ¯”è³½", class: "status-c" }
        ];
        
        // åˆå§‹åŒ–è¡¨æ ¼
        function initAttendanceTable() {
            const tableBody = document.getElementById("attendance-body");
            tableBody.innerHTML = "";
            
            students.forEach(student => {
                const row = document.createElement("tr");
                
                // ç”Ÿæˆç‹€æ…‹é¸æ“‡ä¸‹æ‹‰é¸å–®
                let statusOptionsHTML = "";
                statusOptions.forEach(option => {
                    statusOptionsHTML += `<option value="${option.value}">${option.text}</option>`;
                });
                
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.institution}</td>
                    <td>${student.name}</td>
                    <td>${student.gender === "M" ? "ç”·" : "å¥³"}</td>
                    <td>
                        <select class="status-select ${statusOptions[0].class}" data-id="${student.id}">
                            ${statusOptionsHTML}
                        </select>
                    </td>
                    <td><input type="text" class="remark-input" data-id="${student.id}" placeholder="å¯é¸å‚™è¨»"></td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // æ·»åŠ äº‹ä»¶ç›£è½å™¨
            document.querySelectorAll('.status-select').forEach(select => {
                select.addEventListener('change', function() {
                    // æ›´æ–°é¸å–®æ¨£å¼
                    const selectedOption = statusOptions.find(opt => opt.value === this.value);
                    this.className = `status-select ${selectedOption.class}`;
                    
                    // é‡æ–°ç”Ÿæˆå ±å‘Š
                    generateWhatsAppOutput();
                });
            });
        }
        
        // ç”ŸæˆWhatsAppæ¨é€æ–‡æ¡ˆ
        function generateWhatsAppOutput() {
            const dateInput = document.getElementById("date").value;
            const location = document.getElementById("location").value;
            const coach = document.getElementById("coach").textContent;
            
            // ç²å–ç•¶å‰æ—¥æœŸå’Œæ™‚é–“
            const now = new Date();
            const generatedTime = now.toLocaleString('zh-Hant', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            }).replace('ä¸Šåˆ', '').replace('ä¸‹åˆ', '');
            
            // æ ¼å¼åŒ–è¨“ç·´æ—¥æœŸ
            let trainingDate = "æœªé¸æ“‡æ—¥æœŸ";
            if (dateInput) {
                const dateObj = new Date(dateInput);
                trainingDate = dateObj.toLocaleDateString('zh-Hant', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    weekday: 'long'
                });
            }
            
            // æ”¶é›†å­¸å“¡ç‹€æ…‹
            const attendanceData = [];
            let yesCount = 0, totalCount = students.length;
            
            students.forEach(student => {
                const select = document.querySelector(`.status-select[data-id="${student.id}"]`);
                const remarkInput = document.querySelector(`.remark-input[data-id="${student.id}"]`);
                const status = select.value;
                const statusText = select.options[select.selectedIndex].text;
                const remark = remarkInput.value;
                
                if (status === "Yes") yesCount++;
                
                attendanceData.push({
                    name: student.name,
                    institution: student.institution,
                    gender: student.gender === "M" ? "ç”·" : "å¥³",
                    status: status,
                    statusText: statusText,
                    remark: remark
                });
            });
            
            // è¨ˆç®—å‡ºå¸­ç‡
            const attendanceRate = Math.round((yesCount / totalCount) * 100);
            
            // ç”ŸæˆWhatsAppæ–‡æ¡ˆ
            let output = `ğŸ“ ä¹’ä¹“çƒBéšŠé å‚™ç­è¨“ç·´é»åè¨˜éŒ„ ğŸ“\n\n`;
            output += `ğŸ“… è¨“ç·´æ—¥æœŸï¼š${trainingDate}\n`;
            output += `â° è¨“ç·´æ™‚é–“ï¼šæ˜ŸæœŸå›› 16:00-18:00 / æ˜ŸæœŸå…­ 10:00-13:00\n`;
            output += `ğŸ“ è¨“ç·´åœ°é»ï¼š${location}\n`;
            output += `ğŸ‘¨â€ğŸ« è² è²¬æ•™ç·´ï¼š${coach}\n\n`;
            output += `ğŸ“‹ å­¸å“¡å‡ºå¸­è¨˜éŒ„ï¼š\n`;
            output += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
            
            attendanceData.forEach(student => {
                let line = `â€¢ ${student.name} (${student.institution}, ${student.gender})ï¼š${student.statusText}`;
                if (student.remark) {
                    line += ` - ${student.remark}`;
                }
                output += `${line}\n`;
            });
            
            output += `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n`;
            output += `ğŸ“Š å‡ºå¸­çµ±è¨ˆï¼š\n`;
            output += `âœ… å‡ºå¸­ï¼š${yesCount}äºº\n`;
            output += `ğŸ“ è«‹å‡ï¼š${attendanceData.filter(s => s.status === "Abs").length}äºº\n`;
            output += `âŒ ç„¡æ•…ç¼ºå¸­ï¼š${attendanceData.filter(s => s.status === "O").length}äºº\n`;
            output += `â° é²åˆ°ï¼š${attendanceData.filter(s => s.status === "L").length}äºº\n`;
            output += `ğŸ¤’ ç—…å‡ï¼š${attendanceData.filter(s => s.status === "S").length}äºº\n`;
            output += `ğŸ† å‡ºå¤–æ¯”è³½ï¼š${attendanceData.filter(s => s.status === "C").length}äºº\n`;
            output += `ğŸ“ˆ å‡ºå¸­ç‡ï¼š${attendanceRate}%\n\n`;
            output += `â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n`;
            output += `ğŸ“ æ­¤è¨˜éŒ„ç”±é»åç³»çµ±è‡ªå‹•ç”Ÿæˆ\n`;
            output += `ğŸ• ç”Ÿæˆæ™‚é–“ï¼š${generatedTime}\n`;
            
            // æ›´æ–°è¼¸å‡ºå€åŸŸ
            document.getElementById("whatsapp-output").textContent = output;
            
            // æ›´æ–°çµ±è¨ˆæ•¸æ“šé¡¯ç¤º
            updateAttendanceStats(yesCount, totalCount, attendanceRate);
            
            return output;
        }
        
        // æ›´æ–°å‡ºå¸­çµ±è¨ˆ
        function updateAttendanceStats(yesCount, totalCount, attendanceRate) {
            const statsContainer = document.getElementById("attendance-stats");
            
            statsContainer.innerHTML = `
                <div class="stat-item" style="border-left: 4px solid #2ecc71;">
                    <div class="stat-value">${yesCount}/${totalCount}</div>
                    <div class="stat-label">å‡ºå¸­äººæ•¸</div>
                </div>
                <div class="stat-item" style="border-left: 4px solid #3498db;">
                    <div class="stat-value">${attendanceRate}%</div>
                    <div class="stat-label">å‡ºå¸­ç‡</div>
                </div>
                <div class="stat-item" style="border-left: 4px solid #e74c3c;">
                    <div class="stat-value">${totalCount - yesCount}</div>
                    <div class="stat-label">ç¼ºå¸­äººæ•¸</div>
                </div>
            `;
        }
        
        // æ¨é€åˆ°WhatsApp
        function sendToWhatsApp() {
            const output = document.getElementById("whatsapp-output").textContent;
            if (!output || output.trim() === "") {
                alert("è«‹å…ˆç”Ÿæˆå‡ºå¸­å ±å‘Šï¼");
                return;
            }
            
            // ç·¨ç¢¼è¨Šæ¯å…§å®¹
            const encodedMessage = encodeURIComponent(output);
            const whatsappUrl = `https://wa.me/?text=${encodedMessage}`;
            
            // é–‹å•ŸWhatsAppåˆ†äº«è¦–çª—
            window.open(whatsappUrl, '_blank');
            
            // é¡¯ç¤ºè¤‡è£½æŒ‡ç¤º
            const indicator = document.getElementById("copy-indicator");
            indicator.textContent = "å·²é–‹å•ŸWhatsAppåˆ†äº«è¦–çª—...";
            setTimeout(() => {
                indicator.textContent = "";
            }, 3000);
        }
        
        // é‡è¨­æ‰€æœ‰ç‹€æ…‹
        function resetAllStatus() {
            if (confirm("ç¢ºå®šè¦é‡è¨­æ‰€æœ‰å­¸å“¡çš„å‡ºå¸­ç‹€æ…‹å—ï¼Ÿ")) {
                document.querySelectorAll('.status-select').forEach(select => {
                    select.value = "Yes";
                    const selectedOption = statusOptions.find(opt => opt.value === "Yes");
                    select.className = `status-select ${selectedOption.class}`;
                });
                
                document.querySelectorAll('.remark-input').forEach(input => {
                    input.value = "";
                });
                
                generateWhatsAppOutput();
            }
        }
        
        // åˆå§‹åŒ–é é¢
        document.addEventListener('DOMContentLoaded', function() {
            // è¨­ç½®é»˜èªæ—¥æœŸç‚ºä»Šå¤©
            const today = new Date();
            const formattedDate = today.toISOString().split('T')[0];
            document.getElementById("date").value = formattedDate;
            
            // åˆå§‹åŒ–è¡¨æ ¼
            initAttendanceTable();
            
            // ç¶å®šæŒ‰éˆ•äº‹ä»¶
            document.getElementById("generate-report").addEventListener("click", generateWhatsAppOutput);
            document.getElementById("reset-all").addEventListener("click", resetAllStatus);
            document.getElementById("whatsapp-btn").addEventListener("click", sendToWhatsApp);
            
            // ç•¶æ—¥æœŸæˆ–åœ°é»æ”¹è®Šæ™‚é‡æ–°ç”Ÿæˆå ±å‘Š
            document.getElementById("date").addEventListener("change", generateWhatsAppOutput);
            document.getElementById("location").addEventListener("change", generateWhatsAppOutput);
            
            // åˆå§‹åŒ–å ±å‘Š
            generateWhatsAppOutput();
        });
    </script>
</body>
</html>
